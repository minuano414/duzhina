____
# Хакатон МФТИ "Вертикализация видео"
____
## Весна 2023

## Команда "Дюжина"
Участники: Кайгородов Глеб, Пашков Александр, Поздеев Игнат, Слепов Илья, Чернова Татьяна, Шереметьева Анна

## Реализация
Для выполнения задачи были использованы следующие модели:
1) Предтренированная Yolo для детектирования лиц актеров
2) ResNet-34 для классификации найденных актеров, обученная на кадрах из предоставленных видео
   (ноутбук: `research/training.ipynb`)

Таким образом, после детектирования актера выполняется его классификация для последующего кропа по приоритетам

## Запуск
1) Положить все файлы для инференса в папку `data` (она также заполнена примерами):
   1) Видео
   2) Метаданные с названием (optional)
   3) JSON с приоритетами актеров. Должен содержать в себе только 1 лист с ID (optional)

2) Вызвать `docker-compose up`
3) `docker exec -it <CONTAINER_ID_OR_NAME> bash`
4) `python3 app/main.py --video_file <название файла> --actors_file <название файла> --meta_file <название файла>`.
Например, запустить demo `python3 app/main.py --video_file demo_video.mp4 --actors_file demo_actors_list.json --meta_file demo_meta.json`. Если каких-то файлов (кроме видео) нет - можно просто заполнить любой строкой, например,  `--actors_file abc`
5) Результат выполнения будет выведен в командную строку, а также в файл `<название файла видео>_result.json` в папку `data`

!!! В случае, если какие-то файлы кроме видео не будут загружены, результат будет выведен без учета дополнительной валидации